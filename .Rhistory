virusresults<-test[c(300, # rift valley fever virus - 1 gorilla (4), 3 cattle (1:3)
virusresults<-test[c(#300, # rift valley fever virus - 1 gorilla (4), 3 cattle (1:3)
1016, # picobirnavirus 1 cow (2) # novel - see map : http://www.hindawi.com/journals/bmri/2014/780752/
1021, # Dromedary picobirnavirus 1 cow (2)
1069#, # Lassa virus 1 human (2)
# 1147 # Hyposoter fugitivus ichnovirus
) ,]
getwd()
virusresults<-test[c(#300, # rift valley fever virus - 1 gorilla (4), 3 cattle (1:3)
837, # picobirnavirus 1 cow (2) # novel - see map : http://www.hindawi.com/journals/bmri/2014/780752/
842, # Dromedary picobirnavirus 1 cow (2)
885 #, # Lassa virus 1 human (2)
# 1147 # Hyposoter fugitivus ichnovirus
) ,]
rownames(virusresults)<-c("RVFV",#"RVF virus",
"PV",#"Picobirnavirus",
"PV(D)",#"Picobirnavirus (D)",
"LFV")#'Lassa virus')#,
rownames(virusresults)<-c("RVFV",#"RVF virus",
rownames(virusresults)<-c(#"RVFV",#"RVF virus",
"PV",#"Picobirnavirus",
"PV(D)",#"Picobirnavirus (D)",
"LFV")#'Lassa virus')#,
virusres<-as.data.frame(virusresults)
virusres$virus<-rownames(virusres)
library(ggplot2)
library(plyr)
library(reshape2)
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
virusres[virusres == 0]<-NA
virusres <- virusres[,colSums(is.na(virusres))<nrow(virusres)]
virusres
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
# cbPalette <- c("#999999", "#56B4E9", "#0072B2", "#D55E00", "#CC79A7")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
fruit <- c("apple", "banana", "pear", "pinapple")
str_detect(fruit, "a")
install.packages("stringr")
library(stringr)
str_detect(fruit, "a")
str_detect(fruit, "^a")
test<-c("3-A","2_A","3_A")
str_detect(fruit, "^a")
test<-c("3-A","2_A","3_A")
str_detect(test, "^a")
str_detect(test, "^3")
test(test[str_detect(test, "^3")])<-A
test(test[str_detect(test, "^3")])<-"A"
str_detect(test,"^3")]
(str_detect(test,"^3")<-"A"
)
str_detect(test,"^3")<-"A"
str_detect(test,"^3")#<-"A"
ifelse(str_detect(test,"^3"),test<-"A",NA)
test<-c("3-A","2_A","3_A")
ifelse(str_detect(test,"^3"),test<-"A",test)
data<-read.csv("marsden_test.csv",header=T,row.names=1)
# data<-read.csv("marsden_test_1.csv",header=T,row.names=1)
# data<-read.csv("marsden_test_2.csv",header=T,row.names=1)
head(data)
colnames(data)
ifelse(str_detect(colnames(data),"^human"),test<-"test",)
ifelse(str_detect(colnames(data),"^human"),data<-"test",data)
data<-read.csv("marsden_test.csv",header=T,row.names=1)
ifelse(str_detect(colnames(data),"^human"),colnames(data)<-"test",colnames(data))
data<-read.csv("marsden_test.csv",header=T,row.names=1)
colnames(data)
?gsub
gsub("[_4]","%",colnames(data))
data<-read.csv("marsden_test.csv",header=T,row.names=1)
gsub("[_4]","%",colnames(data))
data<-read.csv("marsden_test.csv",header=T,row.names=1)
gsub("[_4]","_%",colnames(data))
gsub("[_45]","_%",colnames(data))
gsub("[_]","_%",colnames(data))
gsub("[_]","_",colnames(data))
colnames(data)[,1]
colnames(data)[1]
colnames(data)[1]<-"3_S3_R1"
colnames(data)
gsub("[3*]","human",colnames(data))
library(plyr)
colnames(data) <- rename(colnames(data),
c("human_2" = "test"))
colnames(data)
colnames(data) <- rename(colnames(data),
c(
"3_S3_R1"="1","human_2"="2","human_3"="3","gorilla_1","gorilla_2",
"gorilla_3","gorilla_4","gorilla_5","cattle_1","cattle_2",
"cattle_3","cattle_4","cattle_5","control"))
colnames(data)[1:3] <- rename(colnames(data),
c(
"3_S3_R1"="1","human_2"="2","human_3"="3")
)
colnames(data)
colnames(data) <- rename(colnames(data),
c("3_S3_R1"="1","human_2"="2","human_3"="3")
,"gorilla_1"="4","gorilla_2"="5",
"gorilla_3"="6","gorilla_4"="7","gorilla_5"="8",
"cattle_1"="9","cattle_2"="10",
"cattle_3"="11","cattle_4"="12","cattle_5"="13","control"="c"))
colnames(data) <- rename(colnames(data),
c("3_S3_R1"="1","human_2"="2","human_3"="3")
,"gorilla_1"="4","gorilla_2"="5",
"gorilla_3"="6","gorilla_4"="7","gorilla_5"="8",
"cattle_1"="9","cattle_2"="10",
"cattle_3"="11","cattle_4"="12","cattle_5"="13","control"="c")
colnames(data)
colnames(data) <- c("1","human_2","3",
"gorilla_1","gorilla_2",
"6","7","gorilla_5",
"9","cattle_2",
"11","cattle_4","cattle_5","c")
colnames(data)
data<-read.csv("06032015_run_mfp_scan_v5.csv",header=T,row.names=1)
setwd("C:/Users/David Hayman/Dropbox/marsden/ORION__sample_results")
data<-read.csv("06032015_run_mfp_scan_v5.csv",header=T,row.names=1)
colnames(data)
colnames(data) <- c(#"UniqueID",
"human_3_S3_R1",
"human_3-Pur_S17_R1",
"human_3_S3_R2",
"human_3-Pur_S17_R2",
"human_2_S2_R1",
"human_2_S2_R2",
"human_2-Pur_S16_R1",
"human_2-Pur_S16_R2",
"Undetermined_S0_R2",
"Undetermined_S0_R1",
"gorilla_4_S4_R1",
"gorilla_4-Pur_S18_R1",
"gorilla_4_S4_R2",
"gorilla_4-Pur_S18_R2",
"cattle_60-Pur_S26_R1",
"cattle_60-Pur_S26_R2",
"cattle_60_S12_R1",
"cattle_60_S12_R2",
"cattle_56_S11_R1",
"cattle_56_S11_R2",
"cattle_56-Pur_S25_R1",
"cattle_56-Pur_S25_R2",
"cattle_62-Pur_S27_R2",
"cattle_62-Pur_S27_R1",
"cattle_62_S13_R1",
"cattle_62_S13_R2",
"human_1_S1_R2",
"human_1_S1_R1",
"human_1-Pur_S15_R1",
"human_1-Pur_S15_R2",
"gorilla_44_S8_R1",
"gorilla_44_S8_R2",
"gorilla_44-Pur_S22_R1",
"gorilla_44-Pur_S22_R2",
"gorilla_24-Pur_S20_R1",
"gorilla_24_S6_R1",
"gorilla_24_S6_R2",
"gorilla_24-Pur_S20_R2",
"gorilla_14-Pur_S19_R2",
"gorilla_14-Pur_S19_R1",
"gorilla_14_S5_R2",
"gorilla_14_S5_R1",
"gorilla_34-Pur_S21_R2",
"gorilla_34-Pur_S21_R1",
"gorilla_34_S7_R2",
"gorilla_34_S7_R1",
"cattle_52_S10_R2",
"cattle_52_S10_R1",
"cattle_52-Pur_S24_R2",
"cattle_52-Pur_S24_R1",
"cattle_48_S9_R2	48_S9_R1",
"cattle_48-Pur_S23_R2",
"cattle_48-Pur_S23_R1",
"Ctl_S14_R1",
"Ctl_S14_R2",
"Ctl-Pur_S28_R1",
"Ctl-Pur_S28_R2")
data<-data.matrix(data)
# heatmap(data)
heatmap(data)
par(mai=c(2,3,4,5))
heatmap(data)
par(mai=c(5,5,5,5))
heatmap(data)
df1<-data[(data[,14]==0),]
dim(data)
colnames(data)
(data)[1,1]
data<-read.csv("06032015_run_mfp_scan_v5.csv",header=T,row.names=1)
colnames(data)
dim(data)
colnames(data) <- c(#"UniqueID",
"human_3_S3_R1",
"human_3-Pur_S17_R1",
"human_3_S3_R2",
"human_3-Pur_S17_R2",
"human_2_S2_R1",
"human_2_S2_R2",
"human_2-Pur_S16_R1",
"human_2-Pur_S16_R2",
"Undetermined_S0_R2",
"Undetermined_S0_R1",
"gorilla_4_S4_R1",
"gorilla_4-Pur_S18_R1",
"gorilla_4_S4_R2",
"gorilla_4-Pur_S18_R2",
"cattle_60-Pur_S26_R1",
"cattle_60-Pur_S26_R2",
"cattle_60_S12_R1",
"cattle_60_S12_R2",
"cattle_56_S11_R1",
"cattle_56_S11_R2",
"cattle_56-Pur_S25_R1",
"cattle_56-Pur_S25_R2",
"cattle_62-Pur_S27_R2",
"cattle_62-Pur_S27_R1",
"cattle_62_S13_R1",
"cattle_62_S13_R2",
"human_1_S1_R2",
"human_1_S1_R1",
"human_1-Pur_S15_R1",
"human_1-Pur_S15_R2",
"gorilla_44_S8_R1",
"gorilla_44_S8_R2",
"gorilla_44-Pur_S22_R1",
"gorilla_44-Pur_S22_R2",
"gorilla_24-Pur_S20_R1",
"gorilla_24_S6_R1",
"gorilla_24_S6_R2",
"gorilla_24-Pur_S20_R2",
"gorilla_14-Pur_S19_R2",
"gorilla_14-Pur_S19_R1",
"gorilla_14_S5_R2",
"gorilla_14_S5_R1",
"gorilla_34-Pur_S21_R2",
"gorilla_34-Pur_S21_R1",
"gorilla_34_S7_R2",
"gorilla_34_S7_R1",
"cattle_52_S10_R2",
"cattle_52_S10_R1",
"cattle_52-Pur_S24_R2",
"cattle_52-Pur_S24_R1",
"cattle_48_S9_R2",
"cattle_48_S9_R1",
"cattle_48-Pur_S23_R2",
"cattle_48-Pur_S23_R1",
"Ctl_S14_R1",
"Ctl_S14_R2",
"Ctl-Pur_S28_R1",
"Ctl-Pur_S28_R2")
colnames(data)
df1<-data[(data[,55:58]==0),]
dim(df1)
dim(data)
df1<-data[!(data[,55:58]>0),]
dim(df1)
summary(df1)
data<-read.csv("06032015_run_mfp_scan_v5.csv",header=T,row.names=1)
dim(data)
colnames(data) <- c(#"UniqueID",
"human_3_S3_R1",
"human_3-Pur_S17_R1",
"human_3_S3_R2",
"human_3-Pur_S17_R2",
"human_2_S2_R1",
"human_2_S2_R2",
"human_2-Pur_S16_R1",
"human_2-Pur_S16_R2",
"Undetermined_S0_R2",
"Undetermined_S0_R1",
"gorilla_4_S4_R1",
"gorilla_4-Pur_S18_R1",
"gorilla_4_S4_R2",
"gorilla_4-Pur_S18_R2",
"cattle_60-Pur_S26_R1",
"cattle_60-Pur_S26_R2",
"cattle_60_S12_R1",
"cattle_60_S12_R2",
"cattle_56_S11_R1",
"cattle_56_S11_R2",
"cattle_56-Pur_S25_R1",
"cattle_56-Pur_S25_R2",
"cattle_62-Pur_S27_R2",
"cattle_62-Pur_S27_R1",
"cattle_62_S13_R1",
"cattle_62_S13_R2",
"human_1_S1_R2",
"human_1_S1_R1",
"human_1-Pur_S15_R1",
"human_1-Pur_S15_R2",
"gorilla_44_S8_R1",
"gorilla_44_S8_R2",
"gorilla_44-Pur_S22_R1",
"gorilla_44-Pur_S22_R2",
"gorilla_24-Pur_S20_R1",
"gorilla_24_S6_R1",
"gorilla_24_S6_R2",
"gorilla_24-Pur_S20_R2",
"gorilla_14-Pur_S19_R2",
"gorilla_14-Pur_S19_R1",
"gorilla_14_S5_R2",
"gorilla_14_S5_R1",
"gorilla_34-Pur_S21_R2",
"gorilla_34-Pur_S21_R1",
"gorilla_34_S7_R2",
"gorilla_34_S7_R1",
"cattle_52_S10_R2",
"cattle_52_S10_R1",
"cattle_52-Pur_S24_R2",
"cattle_52-Pur_S24_R1",
"cattle_48_S9_R2",
"cattle_48_S9_R1",
"cattle_48-Pur_S23_R2",
"cattle_48-Pur_S23_R1",
"Ctl_S14_R1",
"Ctl_S14_R2",
"Ctl-Pur_S28_R1",
"Ctl-Pur_S28_R2")
dim(data)
data<-data.matrix(data)
df1<-data[(data[,55:58]==0),]
dim(data)
df1<-data[(data[,55:58]>0),]
dim(data)
dim(df1)
df1<-data[(sum(data[,55:58])==0),]
dim(df1)
df1<-data[(sum(data[,55:58])>0),]
dim(df1)
df1<-data[(sum(data[,55:58])>0),]
summary(df1)
sum(data[,55:58])>0)
sum(data[,55:58])>0
df1<-data[!(sum(data[,55:58])>0),]
summary(df1)
dim(df1)
df1<-data[!(sum(data[,55])>0),]
dim(df1)
str(df1)
df1<-data
str(df1)
df1<200
df1<-data[!data[,55:58]>0,]
str(df1)
dim(df1)
df1<-data[!(data[,55]>0,)]
df1<-data[!(data[55]>0),]
dim(df1)
df1<-data[!(data[,55]>0),]
dim(df1)
df1<-data[!(data[,55:58]>0),]
?colsum
?colSum
?colSums
df1<-data[!(rowSums(data[,55:58])>0),]
dim(df1)
summary(df1)
df1<-data[!(rowSums(data[,55:58])>0),]
df2<-df1
df2
dim(df2)
summary(df2)
dim(df1)
df2<-df1[,1:54]
dim(df1)
dim(df2)
test<-df1[,1:54]
heatmap(test)
heatmap(test,labRow=NA)
heatmap(test,labRow=NA,Colv=NA)
heatmap(test,labRow=NA,margins=c(12,7))
heatmap(test,labRow=NA,margins=c(12,7),cexCol=0.8)
heatmap(test,Colv=NA,labRow=NA,margins=c(12,7),cexCol=0.8)
heatmap(test,Colv=NA,labRow=NA,margins=c(12,7),cexCol=0.5)
res<-rownames(test)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(20, alpha = 1),
margins=c(12,7),
ColSideColors = c(rep("lightgrey",3),
rep("darkgrey",5)),
rep("grey",5),
cexCol=1.8)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(20, alpha = 1),
margins=c(12,7),
#         ColSideColors = c(rep("lightgrey",3),
#                           rep("grey",5),
#                           rep("darkgrey",5)),
cexCol=1.8)
heatmap(test,Colv=NA,labRow=NA,margins=c(12,7),cexCol=0.5)
res<-rownames(test)
getwd()
ite.csv(res_clean,"res.csv")
write.csv(res_clean,"res.csv")
write.csv(res,"res_clean.csv")
shopping_list <- c("apples x4", "bag of flour", "bag of sugar", "milk x2")
str_extract(shopping_list, "\\d")
str_extract(shopping_list, "[a-z]+")
str_extract(shopping_list, "[a-z]{1,4}")
str_extract(shopping_list, "\\b[a-z]{1,4}\\b")
str_extract(shopping_list, "[f-z]+")
str_extract(shopping_list, "[app]+")
str_extract(shopping_list, "[app]")
str_extract(res, "[virus]+")
str_extract(res, "[virus]")
pmatch(res, c("virus")) # returns 2
str_extract(res, "[virus]{1,5}")
summary(res)
str_extract(res, "[virus]{1:5}")
str_extract(res, "[virus]")
grep(["virus"],res) # returns 2
grep("[virus]",res) # returns 2
grep("virus",res) # returns 2
test[grep("virus",res),] # returns those with 'virus' in
virusresults<-test[grep("virus",res),] # returns those with 'virus' in
virusres<-as.data.frame(virusresults)
virusres$virus<-rownames(virusres)
library(ggplot2)
library(plyr)
library(reshape2)
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
dim(virusres)
colnames(virusres)
rownames(virusres)
virusres<-virusres[-c(1,6),]
rownames(virusres)
library(ggplot2)
library(plyr)
vres<-melt(virusres)
library(reshape2)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
virusres[virusres == 0]<-NA
virusres <- virusres[,colSums(is.na(virusres))<nrow(virusres)]
virusres
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
vres
virusres<-as.data.frame(virusresults)
virusres$virus<-rownames(virusres)
virusres<-virusres[-c(1,6),]
library(ggplot2)
library(plyr)
library(reshape2)
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
virusres[virusres == 0]<-NA
virusres <- virusres[,colSums(is.na(virusres))<nrow(virusres)]
virusres
vres<-melt(virusres)
vres
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
vres
vres
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
