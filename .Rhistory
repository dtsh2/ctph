"Ctl-Pur_S28_R2")
#
data<-data.matrix(data)
df1<-data[!(rowSums(data[,55:58])>0),]
test<-df1[,1:54]
heatmap(test,Colv=NA,labRow=NA,margins=c(12,7),cexCol=0.5)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(20, alpha = 1),
margins=c(12,7),
ColSideColors = c(rep("lightgrey",3),
rep("grey",5),
rep("darkgrey",5)),
cexCol=1.8)
ncol(data)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(58, alpha = 1),
margins=c(12,7),
ColSideColors = c(rep("lightgrey",3),
rep("grey",5),
rep("darkgrey",5)),
cexCol=1.8)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(20, alpha = 1),
margins=c(12,7),
#         ColSideColors = c(rep("lightgrey",3),
#                           rep("grey",5),
#                           rep("darkgrey",5)),
cexCol=1.8)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(20, alpha = 1),
margins=c(12,7),
#         ColSideColors = c(rep("lightgrey",3),
#                           rep("grey",5),
#                           rep("darkgrey",5)),
cexCol=1)
heatmap(test,Colv=NA,
labRow=NA,col=terrain.colors(20, alpha = 1),
margins=c(12,7),
#         ColSideColors = c(rep("lightgrey",3),
#                           rep("grey",5),
#                           rep("darkgrey",5)),
cexCol=0.6)
res<-rownames(test)
# write.csv(res,"res.csv")
virusresults<-test[grep("virus",res),] # returns those with 'virus' in
virusres<-as.data.frame(virusresults)
virusres$virus<-rownames(virusres)
virusres<-virusres[-c(1,6),]
library(ggplot2)
library(reshape2)
library(plyr)
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))
virusres[virusres == 0]<-NA
virusres <- virusres[,colSums(is.na(virusres))<nrow(virusres)]
virusres
vres<-melt(virusres)
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
# cbPalette <- c("#999999", "#56B4E9", "#0072B2", "#D55E00", "#CC79A7")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
##
names(vres)<-c("virus","host","value")
p <- qplot(x=virus, y=value, fill=host,
data=vres, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+ theme(text = element_text(size=20),
axis.title.x=element_blank(),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
vres
virusres
virusresults
x1 = 1:288
x2 = matrix(x1,nrow=96,ncol=3)
x2
colMeans(matrix(x2[,2],nrow=24))
colMeans(matrix(x2[,1:2],nrow=24))
colMeans(matrix(virusresults[,1:2],nrow=4))
colMeans(matrix(virusresults[,1:4],nrow=6))
rowMeans(matrix(virusresults[,1:4],nrow=6))
rowMeans(matrix(virusresults[,5:8],nrow=6))
vr<-virusresults[,-c(9:10)]
vr
dim(vr)
52/4
length(vr)
vrs<-matrix(NA,nrow = 6, ncol = 13)
vrs
rep(1,4,1)
rep(1:4,1)
rep(1:4,1)*1
rep(1:4,1)*2
seq(1:4,1)*2
seq(1,4,1)*2
seq(1,4,1)*3
rep(1:4,seq(1:$))
rep(1:4,seq(1:4))
rep(1:4,by=1))
rep(1:4,by=1)
rep(1:4,by=2)
rep(1:4,by=3)
rep(1:4)
vr
14*4
seq(1:56,by=4)
seq(from = 1, to = 56,by=4)
ttttt<-seq(from = 1, to = 56,by=4)
ttttt*1:4
ttttt+1:4
ttttt*c(1:4)
ttttt*seq(from = 1, to = 4, by =1)
ttttt+seq(from = 1, to = 4, by =1)
vr[,1:4]
rowMeans(matrix(virusresults[,5:8],nrow=6))
i<-seq(from = 1, to = 56,by=4)
i
1+i
2++i
1:4+i
dim(vr)
dim(virusres)
dim(virusresults)
vr<-virusresults[,-c(9:10)]
dim(vr)
52/4
vrs<-matrix(NA,nrow = 6, ncol = 13)
dim(vrs)
legnth(seq(from = 1, to = 56,by=4))
length(seq(from = 1, to = 56,by=4))
length(seq(from = 1, to = 52,by=4))
vr<-virusresults[,-c(9:10)]
vrs<-matrix(NA,nrow = 6, ncol = 13)
for (i in seq(from = 1, to = 52,by=4)){
for (j in seq(from = 1, to = 4, by = 1)){
vrs[,i] <- rowMeans(matrix(virusresults[,i+j],nrow=6))
}
}
vrs
rowMeans(matrix(virusresults[,i+j],nrow=6))
i
j
rowMeans(matrix(virusresults[,i+j],nrow=6))
vr<-virusresults[,-c(9:10)]
vrs<-matrix(NA,nrow = 6, ncol = 13)
for (i in seq(from = 1, to = 52,by=4)){
j <- seq(from = 1, to = 4, by = 1))
vrs[,i] <- rowMeans(matrix(virusresults[,i+j],nrow=6))
}
vr<-virusresults[,-c(9:10)]
vrs<-matrix(NA,nrow = 6, ncol = 13)
for (i in seq(from = 1, to = 52,by=4)){
j <- seq(from = 1, to = 4, by = 1)
vrs[,i] <- rowMeans(matrix(virusresults[,i+j],nrow=6))
}
vrs
j
i
i<-seq(from = 1, to = 52,by=4)
i
i+j
vrs<-i+j
vrs
vrs<-matrix(NA,nrow = 6, ncol = 13)
vrs
virusresults[,i+j]
library(data.table)
setDT(vrs)
str(vrs)
vr<-virusresults[,-c(9:10)]
vr
setDT(vr)
vr[, .(Mean = rowMeans(.SD)), by = colnames(vr)]
colnames(vr)
vr[, .(Mean = rowMeans(.vr)), by = colnames(vr)]
vr[, .(Mean = rowMeans(vr)), by = colnames(vr)]
vr[, (Mean = rowMeans(vr)), by = colnames(vr)]
by(vr[,],colnames(vr),colMeans)
by(vr[,1:4],colnames(vr),colMeans)
by(vr[1:54,],colnames(vr),colMeans)
by(vr[1:52,],colnames(vr),colMeans)
by(vr[1:6,],colnames(vr),colMeans)
by(vr[1:6,],colMeans)
?by
sapply(colnames(vr), function(x) rowMeans(vr[,x]))
sapply(colnames(vr), function(x) rowMeans(vr[,]))
i
i-1:4
head(vr)
means = lapply(colnames, function(name) { apply(vr[,grep(name, names(vr))], 1, mean) })
means
colnames
colnames = c( "human_3",
"human_2",
"gorilla_4",
"cattle_60",
"cattle_56",
"cattle_62",
"human_1",
"gorilla_44",
"gorilla_24",
"gorilla_14",
"gorilla_34",
"cattle_52",
"cattle_48")
means = lapply(colnames, function(name) { apply(vr[,grep(name, names(vr))], 1, mean) })
means
str(vr)
names(vr)
colnames(vr)
means = lapply(colnames, function(name) { apply(vr[,grep(name, colnames(vr))], 1, mean) })
means
rownames(vr)
colnames(vr)
result = do.call(cbind, means)
result = as.data.frame(t(result))
results
result
colnames(vr)
rownames(result) = colnames
result
vs_r<-melt(results)
vs_r<-melt(result)
vs_r
results
result
vs_r<-melt(t(result))
vs_r
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p <- qplot(x=virus, y=value, fill=variable,
data=vres, geom="bar", stat="identity",
position="stack",ylab="reads")
# cbPalette <- c("#999999", "#56B4E9", "#0072B2", "#D55E00", "#CC79A7")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
vs_r
results
result
result[result == 0]<-NA
result <- result[,colSums(is.na(result))<nrow(result)]
result
vs_r<-melt(t(result))
vs_r
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
result = do.call(cbind, means)
result = as.data.frame(t(result))
rownames(result) = colnames
result[result == 0]<-NA
result
result <- result[,rowSums(is.na(result))<ncol(result)]
result
result <- result[,rowSums(is.na(result))<ncol(result)]
result <- result[rowSums(is.na(result))<ncol(result),]
result
vs_r<-melt(t(result))
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
vs_r
result
colnames(results)
colnames(result)
colnames(result)<-c("Microvirus","Picobirnavirus",
"Dromedary picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
results
result
result<-result[,2:4]
result
colnames(result)<-c("Microvirus","Picobirnavirus",
"D - picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
result = do.call(cbind, means)
result = as.data.frame(t(result))
rownames(result) = colnames
result[result == 0]<-NA
result <- result[rowSums(is.na(result))<ncol(result),]
result
colnames(result)<-c("Microvirus","Picobirnavirus",
"D - picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
result<-result[,2:4]
vs_r<-melt(t(result))
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
result = do.call(cbind, means)
result = as.data.frame(t(result))
rownames(result) = colnames
result[result == 0]<-NA
result <- result[rowSums(is.na(result))<ncol(result),]
result
colnames(result)<-c("Microvirus","Picobirnavirus",
"D - picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
result<-result[,2:5]
vs_r<-melt(t(result))
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="stack",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
qplot
?qplot
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="stack",ylab="reads",asp=1)
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
result = do.call(cbind, means)
result = as.data.frame(t(result))
rownames(result) = colnames
### KEEP TO REMOVE HAs IF NEEDED
# result[result == 0]<-NA
# result <- result[rowSums(is.na(result))<ncol(result),]
# result
colnames(result)<-c("Microvirus","Picobirnavirus",
"D - picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
result<-result[,2:5]
vs_r<-melt(t(result))
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="stack",ylab="reads",asp=1)
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
means = lapply(colnames, function(name) { apply(vr[,grep(name, colnames(vr))], 1, mean) })
# build the result
result = do.call(cbind, means)
result = as.data.frame(t(result))
rownames(result) = colnames
result[result == 0]<-NA
result <- result[rowSums(is.na(result))<ncol(result),]
result
means = lapply(colnames, function(name) { apply(vr[,grep(name, colnames(vr))], 1, mean) })
# build the result
result = do.call(cbind, means)
result = as.data.frame(t(result))
rownames(result) = colnames
colnames(result)<-c("Microvirus","Picobirnavirus",
"D - picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
result<-result[,2:5]
vs_r<-melt(t(result))
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)#+ scale_fill_brewer(palette="Set1")
result[result == 0]<-NA
result <- result[rowSums(is.na(result))<ncol(result),]
result
colnames(result)<-c("Microvirus","Picobirnavirus",
"D - picobirnavirus","Hepatitis C virus",
"Lassa virus","Hyposoter fugitivus ichnovirus")
result<-result[,2:5]
vs_r<-melt(t(result))
colnames(vs_r)<-c("virus","host","reads")
p <- qplot(x=virus, y=reads, fill=host,
data=vs_r, geom="bar", stat="identity",
position="dodge",ylab="reads")
p+theme(text = element_text(size=20),
axis.text.x = element_text(angle=90, vjust=1,colour="grey20"))+
scale_fill_hue(c=90, l=55)+ scale_fill_brewer(palette="Set1")
ggplot(data=vs_s, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge')+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge')+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads)) +
geom_bar(position='dodge')+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads, fill=host),stat="identity") +
geom_bar(position='dodge')+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads, fill=host),stat="bin") +
geom_bar(position='dodge')+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="bin")+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank())
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(axis.title.x=element_blank(),
text = element_text(size=20))
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
text = element_text(size=20))
?theme
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
axis.title.x = element_text(angle = 90),
text = element_text(size=20))
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
axis.title.x = element_text(angle = 0),
text = element_text(size=20))
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
axis.text.x = element_text(angle = 0),
text = element_text(size=20))
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
axis.text.x = element_text(angle = 90),
text = element_text(size=20))
?element_text
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
axis.text.x = element_text(angle = 90,colour = "darkgrey"),
text = element_text(size=20))
# vres[order(v
ggplot(data=vs_r, aes(x=host,y=reads, fill=host)) +
geom_bar(position='dodge',stat="identity")+
facet_wrap( ~virus , nrow=1)+
theme(#axis.title.x=element_blank(),
axis.text.x = element_text(angle = 90,colour = "grey10"),
text = element_text(size=20))
